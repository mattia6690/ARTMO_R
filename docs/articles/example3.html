<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial Link • ArtmoR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Link">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArtmoR</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/motivation.html">Motivation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example0.html">Before Starting</a>
    </li>
    <li>
      <a href="../articles/example1.html">Connect and Get</a>
    </li>
    <li>
      <a href="../articles/example2.html">Explore</a>
    </li>
    <li>
      <a href="../articles/example3.html">Spatial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/changelog.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://www.twitter.com/mattia6690">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://www.github.com/mattia6690">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="example3_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="example3_files/plotly-binding-4.8.0/plotly.js"></script><script src="example3_files/typedarray-0.1/typedarray.min.js"></script><script src="example3_files/jquery-1.11.3/jquery.min.js"></script><link href="example3_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="example3_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><link href="example3_files/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="example3_files/plotly-main-1.39.2/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Spatial Link</h1>
            
      
      
      <div class="hidden name"><code>example3.Rmd</code></div>

    </div>

    
    
<p>This Tutorial is about linking the ARTMO output with Raster Data in R. ARTMO does not provide a unified workflow on how to store Spatial Rasters and how to join Raster Data and model output.</p>
<p>Therefore the steps for combining Model output and Spatial Data cannot be established automatically but has to be manually linked after each iteration. This Tutorial draws a <strong>possible approach for the analysis</strong> of combined modelled and spatial data. The following example <strong>links the MySQL Table with Raster Files and Shapefiles</strong>. The rasters consist of ARTMO Outputs and the Shapefiles have been created a-priori. They are stored as <a href="https://github.com/r-spatial/sf">simple Features (sf)</a>. This format is recommended since it allows to comprise diverse geometric types (points, shapefiles etc.) and to easily link them to tibbles and data frames.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"ArtmoR"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"magrittr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"dplyr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"purrr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"raster"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"ggplot2"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"sf"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"tidyr"</span>)</code></pre></div>
<div id="link-data" class="section level1">
<h1 class="hasAnchor">
<a href="#link-data" class="anchor"></a>Link data</h1>
<p>In a second step we need the Information about which dataset we are analyzing (MLRA, CF …) as well as the directory we are aiming to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dir&lt;-<span class="st">"C:/ARTMO"</span>

stat&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readRDS">readRDS</a></span>(<span class="st">"./data/demo.rds"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(<span class="op">!</span><span class="kw">map_lgl</span>(Results, is.null)) 
stat.spat&lt;-<span class="kw"><a href="../reference/spatDir.html">spatDir</a></span>(stat,dir)</code></pre></div>
<p>What we see is that each entry in the Table is provided with a unique Store.ID. This ID is linked to a Model. This allows to connect each iteration with one Model. It is recommended to use this structurization to store the Spatial Files (or basically every other output from ARTMO)in a subfolder with the StoreID. It is highly recommended to <strong>STORE the Rasters</strong> in the respective folders.</p>
<p>Example. If we want to use both <code>noise = 5</code> algorithm as the <code>algorithm = Exponential</code> as variables the folder structure should be the following. I fyou want you can use the <code>dircheckup</code> function for creating the folders automatically.</p>
<div id="create-subdirectory" class="section level2">
<h2 class="hasAnchor">
<a href="#create-subdirectory" class="anchor"></a>Create Subdirectory</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model.s &lt;-<span class="st">"Model1"</span>
algo.s  &lt;-<span class="st">"Exponential"</span>
noise.s &lt;-<span class="dv">5</span>

subset&lt;-stat.spat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(Model<span class="op">==</span>model.s <span class="op">&amp;</span><span class="st"> </span>algorithm<span class="op">==</span>algo.s <span class="op">&amp;</span><span class="st"> </span>noise<span class="op">==</span>noise.s) 
folder&lt;-subset<span class="op">$</span>SpatDir

folder</code></pre></div>
<pre><code>## [1] "C:/ARTMO/artmo_1/test_cf/Model1/15/"</code></pre>
</div>
</div>
<div id="raster-data" class="section level1">
<h1 class="hasAnchor">
<a href="#raster-data" class="anchor"></a>Raster Data</h1>
<p>Now we want to see which of the following folders contain raster information. Therefore we parse each of the Location and search for generated Raster</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stat.spat.ras&lt;-<span class="kw"><a href="../reference/spatDir.html">spatDir</a></span>(stat,dir,<span class="dt">addraster =</span> T)

stat.spat.ras</code></pre></div>
<pre><code>## # A tibble: 4 x 39
##   Model Database Project PY_ID Date  name_class derivar size_data
##   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;int&gt; &lt;S3: int&gt;
## 1 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 2 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 3 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 4 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## # ... with 31 more variables: estadistico &lt;int&gt;, Spectra &lt;list&gt;,
## #   LUT &lt;list&gt;, Name1 &lt;chr&gt;, Name2 &lt;chr&gt;, clave &lt;chr&gt;, param_user &lt;list&gt;,
## #   algorithm &lt;chr&gt;, normalizar &lt;int&gt;, sim &lt;S3: integer64&gt;, alfa &lt;dbl&gt;,
## #   beta &lt;dbl&gt;, noise &lt;dbl&gt;, train &lt;dbl&gt;, ME &lt;dbl&gt;, RMSE &lt;dbl&gt;,
## #   RELRMSE &lt;dbl&gt;, MAE &lt;dbl&gt;, R &lt;dbl&gt;, R2 &lt;dbl&gt;, NRMSE &lt;dbl&gt;, TS &lt;dbl&gt;,
## #   NSE &lt;dbl&gt;, tictoc &lt;dbl&gt;, Results &lt;list&gt;, Store.ID &lt;int&gt;,
## #   Table_Type &lt;chr&gt;, SpatDir &lt;chr&gt;, RasDir &lt;chr&gt;, RasName &lt;chr&gt;,
## #   Rasters &lt;list&gt;</code></pre>
<p>Do we really have integrated the Raster in the Table???? -&gt; YES!!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl&lt;-stat.spat.ras<span class="op">$</span>Rasters[[<span class="dv">1</span>]]
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(pl)</code></pre></div>
<p><img src="example3_files/figure-html/Raster2Table2-1.png" width="700"></p>
<p>But watch out! It is important to add the Date to the Shapefile</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dates&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"2017-05-24"</span>,<span class="st">"2017-05-31"</span>,<span class="st">"2017-06-07"</span>,<span class="st">"2017-06-15"</span>)

stat.spat.ras&lt;-stat.spat.ras <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">AcqDate=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(dates))</code></pre></div>
</div>
<div id="spatial-data" class="section level1">
<h1 class="hasAnchor">
<a href="#spatial-data" class="anchor"></a>Spatial Data</h1>
<p>But we also need to know about the we need to know about the Simple features/ Shapefiles. These help to evaluate the actual performance of the Model and Validate it. A possible SF File could be like the one here below. Since the Simple Features work as a tibble with geographical annotation it is possible to <strong>add many different properties</strong> such as the date of acquisition, the station, its coordinates or the actual measurement</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(gpsdata,<span class="dt">n=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## Simple feature collection with 20 features and 4 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 688657 ymin: 5141508 xmax: 688681 ymax: 5141541
## epsg (SRID):    32632
## proj4string:    +proj=utm +zone=32 +datum=WGS84 +units=m +no_defs
## # A tibble: 20 x 5
##   Station   AcqDate    OP1   meanLAI           geometry
##   &lt;chr&gt;     &lt;date&gt;     &lt;chr&gt;   &lt;dbl&gt;        &lt;POINT [m]&gt;
## 1 Domef1500 2017-05-10 ID1      1.52   (688657 5141521)
## 2 Domef1500 2017-05-10 ID2      1.05 (688658.9 5141508)
## 3 Domef1500 2017-05-17 ID1      2.13 (688671.6 5141541)
## 4 Domef1500 2017-05-17 ID2      2.12 (688680.4 5141540)
## 5 Domef1500 2017-05-17 ID3      2.51   (688681 5141531)
## # ... with 15 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(gpsdata,<span class="dt">axes=</span>T)</code></pre></div>
<p><img src="example3_files/figure-html/GPSPrint-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(gpsdata[<span class="st">"meanLAI"</span>],<span class="dt">axes=</span>T)</code></pre></div>
<p><img src="example3_files/figure-html/GPSPrint-2.png" width="700"></p>
</div>
<div id="connect-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#connect-datasets" class="anchor"></a>Connect Datasets</h1>
<p>The Simple Feature is simply added to the Database we generated with the steps a-priori as a new columns. It is again considerated as a nested element</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stat.spat.ras.sf&lt;-stat.spat.ras <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">Features=</span><span class="kw">map</span>(AcqDate,<span class="cf">function</span>(x){
    
    gpsdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(AcqDate<span class="op">==</span>x) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(.)
    
  }))

stat.spat.ras.sf</code></pre></div>
<pre><code>## # A tibble: 4 x 41
##   Model Database Project PY_ID Date  name_class derivar size_data
##   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;int&gt; &lt;S3: int&gt;
## 1 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 2 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 3 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 4 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## # ... with 33 more variables: estadistico &lt;int&gt;, Spectra &lt;list&gt;,
## #   LUT &lt;list&gt;, Name1 &lt;chr&gt;, Name2 &lt;chr&gt;, clave &lt;chr&gt;, param_user &lt;list&gt;,
## #   algorithm &lt;chr&gt;, normalizar &lt;int&gt;, sim &lt;S3: integer64&gt;, alfa &lt;dbl&gt;,
## #   beta &lt;dbl&gt;, noise &lt;dbl&gt;, train &lt;dbl&gt;, ME &lt;dbl&gt;, RMSE &lt;dbl&gt;,
## #   RELRMSE &lt;dbl&gt;, MAE &lt;dbl&gt;, R &lt;dbl&gt;, R2 &lt;dbl&gt;, NRMSE &lt;dbl&gt;, TS &lt;dbl&gt;,
## #   NSE &lt;dbl&gt;, tictoc &lt;dbl&gt;, Results &lt;list&gt;, Store.ID &lt;int&gt;,
## #   Table_Type &lt;chr&gt;, SpatDir &lt;chr&gt;, RasDir &lt;chr&gt;, RasName &lt;chr&gt;,
## #   Rasters &lt;list&gt;, AcqDate &lt;date&gt;, Features &lt;list&gt;</code></pre>
<p>And a plot on how the Shapefiles and the Raster Files are connected now:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ras&lt;-stat.spat.ras.sf<span class="op">$</span>Rasters[[<span class="dv">1</span>]][[<span class="dv">1</span>]]
shp&lt;-stat.spat.ras.sf<span class="op">$</span>Features[[<span class="dv">1</span>]]

<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(ras)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw">st_geometry</span>(shp),<span class="dt">fill=</span><span class="st">"black"</span>,<span class="dt">add=</span>T)</code></pre></div>
<p><img src="example3_files/figure-html/PlotRas-1.png" width="700"></p>
</div>
<div id="plot" class="section level1">
<h1 class="hasAnchor">
<a href="#plot" class="anchor"></a>Plot</h1>
<p>Now we can use the Raster and Feature from each of the Files to extract the Raster values at the exact same location as the Points are and combine them to the actual measurements in the Spatial Data Frame</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">measure&lt;-<span class="st">"meanLAI"</span>

result&lt;-<span class="kw"><a href="../reference/spatRes.html">spatRes</a></span>(stat.spat.ras.sf,<span class="dt">col =</span> measure)


<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(result)</code></pre></div>
<pre><code>## # A tibble: 4 x 43
##   Model Database Project PY_ID Date  name_class derivar size_data
##   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;int&gt; &lt;S3: int&gt;
## 1 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 2 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 3 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## 4 Mode~ artmo_1  Mattia1 1     2018~ Full_image       0 1000     
## # ... with 35 more variables: estadistico &lt;int&gt;, Spectra &lt;list&gt;,
## #   LUT &lt;list&gt;, Name1 &lt;chr&gt;, Name2 &lt;chr&gt;, clave &lt;chr&gt;, param_user &lt;list&gt;,
## #   algorithm &lt;chr&gt;, normalizar &lt;int&gt;, sim &lt;S3: integer64&gt;, alfa &lt;dbl&gt;,
## #   beta &lt;dbl&gt;, noise &lt;dbl&gt;, train &lt;dbl&gt;, ME &lt;dbl&gt;, RMSE &lt;dbl&gt;,
## #   RELRMSE &lt;dbl&gt;, MAE &lt;dbl&gt;, R &lt;dbl&gt;, R2 &lt;dbl&gt;, NRMSE &lt;dbl&gt;, TS &lt;dbl&gt;,
## #   NSE &lt;dbl&gt;, tictoc &lt;dbl&gt;, Results &lt;list&gt;, Store.ID &lt;int&gt;,
## #   Table_Type &lt;chr&gt;, SpatDir &lt;chr&gt;, RasDir &lt;chr&gt;, RasName &lt;chr&gt;,
## #   Rasters &lt;list&gt;, AcqDate &lt;date&gt;, Features &lt;list&gt;, Spat.Result &lt;list&gt;,
## #   Spat.Lm &lt;dbl&gt;</code></pre>
<p>To finish we compare the Modelled Results to the ones Measured in the Field at a given Location</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">selection&lt;-result <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(RasName,Features,Spat.Result) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>unnest <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Date=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(AcqDate))

g1&lt;-<span class="kw">ggplot</span>(selection,<span class="kw">aes</span>(Simulated,Measured,<span class="dt">color=</span>Date))<span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">"lm"</span>,<span class="dt">se=</span>F,<span class="dt">col=</span><span class="st">"brown"</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept=</span><span class="dv">0</span>,<span class="dt">slope=</span><span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">"dotted"</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(.<span class="op">~</span>Station,<span class="dt">ncol=</span><span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Estimated LAI"</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">"Measured LAI"</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot.window">ylim</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">10</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot.window">xlim</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">10</span>))
g1</code></pre></div>
<p><img src="example3_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Or make it interactive using the ggplotly package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"plotly"</span>)
<span class="kw">ggplotly</span>(g1)</code></pre></div>
<div id="htmlwidget-571b0400de5777816139" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-571b0400de5777816139">{"x":{"data":[{"x":[2.12827515602112,2.12827515602112,1.98791694641113],"y":[3.141,2.219,3.792],"text":["Simulated: 2.128275<br />Measured: 3.141<br />Date: 2017-05-24","Simulated: 2.128275<br />Measured: 2.219<br />Date: 2017-05-24","Simulated: 1.987917<br />Measured: 3.792<br />Date: 2017-05-24"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"2017-05-24","legendgroup":"2017-05-24","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.50423645973206,2.52156043052673,2.58058977127075],"y":[3.694,3.042,4.965],"text":["Simulated: 2.504236<br />Measured: 3.694<br />Date: 2017-05-31","Simulated: 2.521560<br />Measured: 3.042<br />Date: 2017-05-31","Simulated: 2.580590<br />Measured: 4.965<br />Date: 2017-05-31"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)"}},"hoveron":"points","name":"2017-05-31","legendgroup":"2017-05-31","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.49786925315857,2.50423645973206,2.52156043052673,2.58058977127075],"y":[4.845,4.517,3.673,4.625],"text":["Simulated: 2.497869<br />Measured: 4.845<br />Date: 2017-06-07","Simulated: 2.504236<br />Measured: 4.517<br />Date: 2017-06-07","Simulated: 2.521560<br />Measured: 3.673<br />Date: 2017-06-07","Simulated: 2.580590<br />Measured: 4.625<br />Date: 2017-06-07"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"2017-06-07","legendgroup":"2017-06-07","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.20216989517212,2.25055170059204,2.23252892494202,2.25087976455688],"y":[5.874,5.776,4.381,6.394],"text":["Simulated: 2.202170<br />Measured: 5.874<br />Date: 2017-06-15","Simulated: 2.250552<br />Measured: 5.776<br />Date: 2017-06-15","Simulated: 2.232529<br />Measured: 4.381<br />Date: 2017-06-15","Simulated: 2.250880<br />Measured: 6.394<br />Date: 2017-06-15"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)"}},"hoveron":"points","name":"2017-06-15","legendgroup":"2017-06-15","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.98791694641113,1.99541913406758,2.00292132172403,2.01042350938049,2.01792569703694,2.02542788469339,2.03293007234984,2.04043226000629,2.04793444766274,2.05543663531919,2.06293882297564,2.07044101063209,2.07794319828854,2.08544538594499,2.09294757360145,2.1004497612579,2.10795194891435,2.1154541365708,2.12295632422725,2.1304585118837,2.13796069954015,2.1454628871966,2.15296507485305,2.1604672625095,2.16796945016595,2.1754716378224,2.18297382547886,2.19047601313531,2.19797820079176,2.20548038844821,2.21298257610466,2.22048476376111,2.22798695141756,2.23548913907401,2.24299132673046,2.25049351438691,2.25799570204336,2.26549788969982,2.27300007735627,2.28050226501272,2.28800445266917,2.29550664032562,2.30300882798207,2.31051101563852,2.31801320329497,2.32551539095142,2.33301757860787,2.34051976626432,2.34802195392077,2.35552414157723,2.36302632923368,2.37052851689013,2.37803070454658,2.38553289220303,2.39303507985948,2.40053726751593,2.40803945517238,2.41554164282883,2.42304383048528,2.43054601814173,2.43804820579819,2.44555039345464,2.45305258111109,2.46055476876754,2.46805695642399,2.47555914408044,2.48306133173689,2.49056351939334,2.49806570704979,2.50556789470624,2.51307008236269,2.52057227001914,2.5280744576756,2.53557664533205,2.5430788329885,2.55058102064495,2.5580832083014,2.56558539595785,2.5730875836143,2.58058977127075],"y":[4.19146465005973,4.19481144888217,4.19815824770462,4.20150504652706,4.20485184534951,4.20819864417195,4.2115454429944,4.21489224181684,4.21823904063929,4.22158583946173,4.22493263828417,4.22827943710662,4.23162623592906,4.23497303475151,4.23831983357395,4.2416666323964,4.24501343121884,4.24836023004129,4.25170702886373,4.25505382768618,4.25840062650862,4.26174742533106,4.26509422415351,4.26844102297595,4.2717878217984,4.27513462062084,4.27848141944329,4.28182821826573,4.28517501708818,4.28852181591062,4.29186861473307,4.29521541355551,4.29856221237795,4.3019090112004,4.30525581002284,4.30860260884529,4.31194940766773,4.31529620649018,4.31864300531262,4.32198980413507,4.32533660295751,4.32868340177995,4.3320302006024,4.33537699942484,4.33872379824729,4.34207059706973,4.34541739589218,4.34876419471462,4.35211099353707,4.35545779235951,4.35880459118196,4.3621513900044,4.36549818882684,4.36884498764929,4.37219178647173,4.37553858529418,4.37888538411662,4.38223218293907,4.38557898176151,4.38892578058396,4.3922725794064,4.39561937822885,4.39896617705129,4.40231297587373,4.40565977469618,4.40900657351862,4.41235337234107,4.41570017116351,4.41904696998596,4.4223937688084,4.42574056763085,4.42908736645329,4.43243416527574,4.43578096409818,4.43912776292062,4.44247456174307,4.44582136056551,4.44916815938796,4.4525149582104,4.45586175703285],"text":["Simulated: 1.987917<br />Measured: 4.191465<br />Date: brown","Simulated: 1.995419<br />Measured: 4.194811<br />Date: brown","Simulated: 2.002921<br />Measured: 4.198158<br />Date: brown","Simulated: 2.010424<br />Measured: 4.201505<br />Date: brown","Simulated: 2.017926<br />Measured: 4.204852<br />Date: brown","Simulated: 2.025428<br />Measured: 4.208199<br />Date: brown","Simulated: 2.032930<br />Measured: 4.211545<br />Date: brown","Simulated: 2.040432<br />Measured: 4.214892<br />Date: brown","Simulated: 2.047934<br />Measured: 4.218239<br />Date: brown","Simulated: 2.055437<br />Measured: 4.221586<br />Date: brown","Simulated: 2.062939<br />Measured: 4.224933<br />Date: brown","Simulated: 2.070441<br />Measured: 4.228279<br />Date: brown","Simulated: 2.077943<br />Measured: 4.231626<br />Date: brown","Simulated: 2.085445<br />Measured: 4.234973<br />Date: brown","Simulated: 2.092948<br />Measured: 4.238320<br />Date: brown","Simulated: 2.100450<br />Measured: 4.241667<br />Date: brown","Simulated: 2.107952<br />Measured: 4.245013<br />Date: brown","Simulated: 2.115454<br />Measured: 4.248360<br />Date: brown","Simulated: 2.122956<br />Measured: 4.251707<br />Date: brown","Simulated: 2.130459<br />Measured: 4.255054<br />Date: brown","Simulated: 2.137961<br />Measured: 4.258401<br />Date: brown","Simulated: 2.145463<br />Measured: 4.261747<br />Date: brown","Simulated: 2.152965<br />Measured: 4.265094<br />Date: brown","Simulated: 2.160467<br />Measured: 4.268441<br />Date: brown","Simulated: 2.167969<br />Measured: 4.271788<br />Date: brown","Simulated: 2.175472<br />Measured: 4.275135<br />Date: brown","Simulated: 2.182974<br />Measured: 4.278481<br />Date: brown","Simulated: 2.190476<br />Measured: 4.281828<br />Date: brown","Simulated: 2.197978<br />Measured: 4.285175<br />Date: brown","Simulated: 2.205480<br />Measured: 4.288522<br />Date: brown","Simulated: 2.212983<br />Measured: 4.291869<br />Date: brown","Simulated: 2.220485<br />Measured: 4.295215<br />Date: brown","Simulated: 2.227987<br />Measured: 4.298562<br />Date: brown","Simulated: 2.235489<br />Measured: 4.301909<br />Date: brown","Simulated: 2.242991<br />Measured: 4.305256<br />Date: brown","Simulated: 2.250494<br />Measured: 4.308603<br />Date: brown","Simulated: 2.257996<br />Measured: 4.311949<br />Date: brown","Simulated: 2.265498<br />Measured: 4.315296<br />Date: brown","Simulated: 2.273000<br />Measured: 4.318643<br />Date: brown","Simulated: 2.280502<br />Measured: 4.321990<br />Date: brown","Simulated: 2.288004<br />Measured: 4.325337<br />Date: brown","Simulated: 2.295507<br />Measured: 4.328683<br />Date: brown","Simulated: 2.303009<br />Measured: 4.332030<br />Date: brown","Simulated: 2.310511<br />Measured: 4.335377<br />Date: brown","Simulated: 2.318013<br />Measured: 4.338724<br />Date: brown","Simulated: 2.325515<br />Measured: 4.342071<br />Date: brown","Simulated: 2.333018<br />Measured: 4.345417<br />Date: brown","Simulated: 2.340520<br />Measured: 4.348764<br />Date: brown","Simulated: 2.348022<br />Measured: 4.352111<br />Date: brown","Simulated: 2.355524<br />Measured: 4.355458<br />Date: brown","Simulated: 2.363026<br />Measured: 4.358805<br />Date: brown","Simulated: 2.370529<br />Measured: 4.362151<br />Date: brown","Simulated: 2.378031<br />Measured: 4.365498<br />Date: brown","Simulated: 2.385533<br />Measured: 4.368845<br />Date: brown","Simulated: 2.393035<br />Measured: 4.372192<br />Date: brown","Simulated: 2.400537<br />Measured: 4.375539<br />Date: brown","Simulated: 2.408039<br />Measured: 4.378885<br />Date: brown","Simulated: 2.415542<br />Measured: 4.382232<br />Date: brown","Simulated: 2.423044<br />Measured: 4.385579<br />Date: brown","Simulated: 2.430546<br />Measured: 4.388926<br />Date: brown","Simulated: 2.438048<br />Measured: 4.392273<br />Date: brown","Simulated: 2.445550<br />Measured: 4.395619<br />Date: brown","Simulated: 2.453053<br />Measured: 4.398966<br />Date: brown","Simulated: 2.460555<br />Measured: 4.402313<br />Date: brown","Simulated: 2.468057<br />Measured: 4.405660<br />Date: brown","Simulated: 2.475559<br />Measured: 4.409007<br />Date: brown","Simulated: 2.483061<br />Measured: 4.412353<br />Date: brown","Simulated: 2.490564<br />Measured: 4.415700<br />Date: brown","Simulated: 2.498066<br />Measured: 4.419047<br />Date: brown","Simulated: 2.505568<br />Measured: 4.422394<br />Date: brown","Simulated: 2.513070<br />Measured: 4.425741<br />Date: brown","Simulated: 2.520572<br />Measured: 4.429087<br />Date: brown","Simulated: 2.528074<br />Measured: 4.432434<br />Date: brown","Simulated: 2.535577<br />Measured: 4.435781<br />Date: brown","Simulated: 2.543079<br />Measured: 4.439128<br />Date: brown","Simulated: 2.550581<br />Measured: 4.442475<br />Date: brown","Simulated: 2.558083<br />Measured: 4.445821<br />Date: brown","Simulated: 2.565585<br />Measured: 4.449168<br />Date: brown","Simulated: 2.573088<br />Measured: 4.452515<br />Date: brown","Simulated: 2.580590<br />Measured: 4.455862<br />Date: brown"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.77952755905512,"color":"rgba(165,42,42,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,10.5],"y":[-0.5,10.5],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dot"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":39.5141341357194,"r":7.30593607305936,"b":41.7789743183678,"l":48.9497716894977},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.5,10.5],"tickmode":"array","ticktext":["0.0","2.5","5.0","7.5","10.0"],"tickvals":[0,2.5,5,7.5,10],"categoryorder":"array","categoryarray":["0.0","2.5","5.0","7.5","10.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"annotations":[{"text":"Estimated LAI","x":0.5,"y":-0.0196373426241191,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"Measured LAI","x":-0.0183953033268102,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"Domef1500","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Date","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.5,10.5],"tickmode":"array","ticktext":["0.0","2.5","5.0","7.5","10.0"],"tickvals":[0,2.5,5,7.5,10],"categoryorder":"array","categoryarray":["0.0","2.5","5.0","7.5","10.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96395248281826},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"16984d3268a2":{"x":{},"y":{},"colour":{},"type":"scatter"},"1698753774b":{"x":{},"y":{},"colour":{}},"16986dd2b33":{"intercept":{},"slope":{}}},"cur_data":"16984d3268a2","visdat":{"16984d3268a2":["function (y) ","x"],"1698753774b":["function (y) ","x"],"16986dd2b33":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#link-data">Link data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#create-subdirectory">Create Subdirectory</a></li>
      </ul>
</li>
      <li><a href="#raster-data">Raster Data</a></li>
      <li><a href="#spatial-data">Spatial Data</a></li>
      <li><a href="#connect-datasets">Connect Datasets</a></li>
      <li><a href="#plot">Plot</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mattia Rossi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
